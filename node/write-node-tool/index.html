<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>如何用node实现命令行工具</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/assets/css/12.styles.a0434713.css" as="style"><link rel="preload" href="/assets/js/app.0da1d625.js" as="script"><link rel="preload" href="/assets/js/5.8f4ff283.js" as="script"><link rel="prefetch" href="/assets/js/1.e2740073.js"><link rel="prefetch" href="/assets/js/0.99cb046d.js"><link rel="prefetch" href="/assets/js/2.a20a70d4.js"><link rel="prefetch" href="/assets/js/3.b4e8f65d.js"><link rel="prefetch" href="/assets/js/4.e44d79b2.js"><link rel="prefetch" href="/assets/js/6.60f6669f.js"><link rel="prefetch" href="/assets/js/7.55ed3787.js"><link rel="prefetch" href="/assets/js/8.96ac15ff.js"><link rel="prefetch" href="/assets/js/9.14991737.js"><link rel="prefetch" href="/assets/js/10.f82e1c9d.js"><link rel="prefetch" href="/assets/js/11.248839f8.js">
    <link rel="stylesheet" href="/assets/css/12.styles.a0434713.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/" class="home-link router-link-active"></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><!----></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><!----></nav><ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading open"><span>node</span><span class="arrow down"></span></p><ul class="sidebar-group-items"><li><a href="/node/how-to-write-a-npm-module/" class="sidebar-link">如何发布一个npm module包</a></li><li><a href="/node/difference-between-local-and-global-module/" class="sidebar-link">局部包和全局包的区别</a></li><li><a href="/node/use-local-node-module-without-publish/" class="sidebar-link">快速使用本地的node module</a></li><li><a href="/node/write-node-tool/" class="active sidebar-link">如何用node实现命令行工具</a><ul class="sidebar-sub-headers"></ul></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>设计模式</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>SPA路由</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>React</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Shell</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Parcel</span><span class="arrow right"></span></p><!----></div></li></ul></div><div class="page"><div class="content"><h1 id="如何用node实现命令行工具"><a href="#如何用node实现命令行工具" aria-hidden="true" class="header-anchor">#</a> 如何用node实现命令行工具</h1><h3 id="介绍概念"><a href="#介绍概念" aria-hidden="true" class="header-anchor">#</a> 介绍概念</h3><ol><li>脚本：假设我们创建了一个文件为script.js，这个文件称为脚本</li><li>运行脚本：<code>node script.js</code>这个过程叫运行脚本</li></ol><h3 id="从运行脚本到命令行工具经过哪些步骤"><a href="#从运行脚本到命令行工具经过哪些步骤" aria-hidden="true" class="header-anchor">#</a> 从运行脚本到命令行工具经过哪些步骤</h3><ol><li>创建脚本</li><li>设置脚本运行环境</li><li>修改脚本权限</li><li>设置环境变量</li><li>运行脚本</li></ol><h3 id="一步一步实现一个命令行工具"><a href="#一步一步实现一个命令行工具" aria-hidden="true" class="header-anchor">#</a> 一步一步实现一个命令行工具</h3><ol><li>node script.js 阶段</li></ol><ul><li>新建一个文件夹 <code>mkdir node-tool</code></li><li><code>cd node-tool</code></li><li>新建一个文件，<code>touch script.js</code>, 内容<code>console.log('Hi, node tool');</code></li><li>命令行执行<code>node script.js</code></li></ul><ol start="2"><li><code>./script.js</code> 阶段</li></ol><ul><li>在命令行直接执行<code>./script.js</code>会提示<code>permission denied: ./script.js</code>，这是因为我们没有执行权限，解决办法
<code>chmod -R 777 script.js</code></li><li>继续执行<code>./script.js</code>，报错如下
<img src="/assets/img/1.08c54d66.png" alt="img">
这是因为脚本默认的执行环境是shell，shell里没有<code>console.log</code>，需要我们指定脚本的执行环境，修改后的script.js</li></ul><div class="language-javascript extra-class"><pre class="language-javascript"><code>#<span class="token operator">!</span><span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>bin<span class="token operator">/</span>node
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Hi, node tool'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>我们想直接在命令行运行script.js，这样看起来像一个完整的命令，执行后报错
<img src="/assets/img/2.fa1f790c.png" alt="img"></li></ul><p>这里我们要清楚一点：可以直接在命令行里执行的命令是因为我们把它放在了/usr/local/bin/目录下，我们可以尝试手动复制script.js到bin下，执行script.js，可以正常执行，所以我们的思路就是想办法把script.js命令和环境变量管理起来，在命令行里面执行：<code>ln script.js /usr/local/bin/script</code>，这行命令是将script.js复制到bin下为script。</p><ol start="3"><li><code>script</code>阶段
我们创建一个package.json文件，并添加下列代码</li></ol><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token string">&quot;bin&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token string">&quot;my-script&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;./script.js&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>然后在命令行输入npm link,出现
<img src="/assets/img/3.3231c8ab.png" alt="img">
我们可以在node/xxx/bin/下看见myscript文件
<img src="/assets/img/4.8f5516b2.png" alt="img">
此时我们在任何地方都可以执行my-script命令</p><p>以上3步可以简单的实现一个命令行工具。</p><p>删除命令行工具：<code>npm unlink</code></p></div><div class="page-edit"><!----><!----></div><div class="page-nav"><p class="inner"><span class="prev">
        ← <a href="/node/use-local-node-module-without-publish/" class="prev">
          快速使用本地的node module
        </a></span><span class="next"><a href="/js-design-pattern/publish-subscribe-pattern/">
          订阅发布模式
        </a> →
      </span></p></div></div></div></div>
    <script src="/assets/js/5.8f4ff283.js" defer></script><script src="/assets/js/app.0da1d625.js" defer></script>
  </body>
</html>
